

<div class="page page-table" button-permission-binder parentName="Reports" pageName="Demand Report">
    <div class="modal-header">
        <h4 class="modal-title">Demand Reports</h4>
    </div>
    <section class="panel panel-default table-dynamic">
        <form name="myFormSiteModal" class="ng-scope ng-pristine ng-invalid ng-invalid-required">
            <!--<div class="form-group col-md-12">
                <div class="form-group col-md-3">
                    <button class="btn-sm btn-primary" ng-click="exportData1()"> <span class="glyphicon glyphicon-plus"> </span> Export full Demand List</button>
                </div>
                <div class="form-group col-md-3">
                    <button class="btn-sm btn-primary" ng-click="exportData()"> <span class="glyphicon glyphicon-plus"> </span> Export current page Demand List</button>
                </div>
            </div>-->
            <div class="form-group col-md-12">
                <!--<div class="form-group col-md-3">
        <label for="site-name">Select City <span style="color:red;">*</span></label><br>
        <select class="form-control" id="site-name" ng-model="Demanddata.Cityid">
            <option value="">---SELECT---</option>
            <option value="{{city.Cityid}}" ng-repeat="city in cities"> {{city.CityName}}</option>
        </select>
    </div>-->
                <!--<div class="form-group col-md-2">
        <label for="site-name">Zone</label><br>
        <select class="form-control" id="site-name" ng-model="Demanddata.ZoneId" ng-change="GetRegions(Demanddata.ZoneId)">
            <option value="">---Select Zone---</option>
            <option value="{{zone.ZoneId}}" ng-repeat="zone in zones"> {{zone.ZoneName}}</option>
        </select>
    </div>
    <div class="form-group col-md-2">
        <label for="site-name">Region</label><br>
        <select class="form-control" id="site-name" ng-model="Demanddata.RegionId" ng-change="GetWarehouses(Demanddata.RegionId)">
            <option value="">---Select Region---</option>
            <option value="{{region.RegionId}}" ng-repeat="region in regions"> {{region.RegionName}}</option>
        </select>
    </div>-->
                <div class="form-group col-md-2">
                    <label for="site-name">Warehouse</label> <span style="color:red">*</span> <br>
                    <select class="form-control" id="site-name" ng-model="Demanddata.WarehouseId" ng-change="getRequiredData(Demanddata.WarehouseId)">
                        <option value="">---Select Warehouse---</option>
                        <option value="{{warehouse.value}}" ng-repeat="warehouse in warehouses">{{warehouse.label}} </option>
                    </select>
                </div>
                <div class="form-group col-md-2">
                    <label for="site-name">Supplier</label><br>
                    <select class="form-control" id="site-name" ng-model="Demanddata.supplierId">
                        <option value="">---SELECT ---</option>
                        <option value="{{supplier.SupplierId}}" ng-repeat="supplier in suppliers"> {{supplier.SupplierName}}</option>
                    </select>
                </div>
                <div class="form-group col-md-6">
                    <label for="site-name">Item Name</label><br>
                    <div class="form-group  col-md-4">
                        <input name="itemName" id="itemname" ng-model="Demanddata.ItemName" type='text' class="form-control" />
                    </div>
                    <div class="form-group  col-md-2">
                        <button type="button" class="btn btn-ar btn-primary" style="padding: 6px 4px" ng-click="SearchItem(Demanddata)">Item Search</button>
                    </div>
                    <div class="form-group col-md-6">
                        <select class="form-control" id="site-name" ng-model="Demanddata.ItemMultiMRPId">
                            <option value="">---SELECT ALL---</option>
                            <option value="{{warehouseitem.ItemMultiMRPId}}" ng-repeat="warehouseitem in warehouseitems"> {{warehouseitem.itemnameWithMOQ}}</option>
                        </select>
                    </div>
                </div>
                <div class="form-group col-md-2">
                    <label for="site-name">&nbsp;</label><br>
                    <button type="button" class="btn btn-ar btn-primary" ng-click="Search(Demanddata)">Search</button>
                    <button type="button" class="btn btn-ar btn-primary" ng-click="exportData1(Demanddata)">Export</button>
                </div>
                          
            </div>
 
            <div class="table-filters">
                <div class="row">
                    <div class="col-sm-4 col-xs-6">
                        <div class="form-group col-md-12">
                            <input type="text" placeholder="search" class="form-control" data-ng-model="searchKeywords" data-ng-keyup="search()">
                        </div>
                    </div>
                    <div class="col-sm-3 col-xs-6 filter-result-info">
                        <span>
                            Showing {{filteredStores.length}}/{{stores.length}} entries
                        </span>
                    </div>
                    <div class="col-sm-4 col-xs-6">

                        <div class="form-group col-md-12">
                            <span ng-if="(UserRoleBackend.rolenames.indexOf('Hub purchase associate')>-1  || UserRoleBackend.rolenames.indexOf('HQ Purchase Executive')>-1)">
                                <button type="button" class="btn btn-ar btn-primary" ng-click="SubmitForPR()">Create PR</button>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div id="exportable">
                <div>
                    <table class="table table-bordered table-responsive">
                        <thead>
                            <tr>
                                <th>
                                    <div class="th">

                                    </div>
                                </th>
                                <th>
                                    <div class="th">
                                        SNo.
                                    </div>
                                </th>
                                <!--<th>
                                    <div class="th">
                                        Supplier Name (Item)
                                        <span class="glyphicon glyphicon-chevron-up"
                                              data-ng-click="order('MinOrderQty')"
                                              data-ng-class="{active: row == 'MinOrderQty'}"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              data-ng-click="order('-MinOrderQty')"
                                              data-ng-class="{active: row == '-MinOrderQty'}"></span>
                                    </div>
                                </th>-->
                                <th>
                                    <div class="th">
                                        Item MultiMRPId
                                        <span class="glyphicon glyphicon-chevron-up"
                                              data-ng-click="order('ItemCode')"
                                              data-ng-class="{active: row == 'ItemCode'}"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              data-ng-click="order('-ItemCode')"
                                              data-ng-class="{active: row == '-ItemCode'}"></span>
                                    </div>
                                </th>
                                <th>
                                    <div class="th">
                                        Item Code
                                        <span class="glyphicon glyphicon-chevron-up"
                                              data-ng-click="order('ItemCode')"
                                              data-ng-class="{active: row == 'ItemCode'}"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              data-ng-click="order('-ItemCode')"
                                              data-ng-class="{active: row == '-ItemCode'}"></span>
                                    </div>
                                </th>
                                <th>
                                    <div class="th">
                                        Item Name
                                        <span class="glyphicon glyphicon-chevron-up"
                                              data-ng-click="order('itemname')"
                                              data-ng-class="{active: row == 'itemname'}"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              data-ng-click="order('-itemname')"
                                              data-ng-class="{active: row == '-itemname'}"></span>
                                    </div>
                                </th>

                                <th>
                                    <div class="th">
                                        ABC Classification

                                    </div>
                                </th>

                                <th>
                                    <div class="th">
                                        Open PO Qty
                                        <span class="glyphicon glyphicon-chevron-up"
                                              data-ng-click="order('qty')"
                                              data-ng-class="{active: row == 'qty'}"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              data-ng-click="order('-qty')"
                                              data-ng-class="{active: row == '-qty'}"></span>
                                    </div>
                                </th>

                                <th>
                                    <div class="th">
                                        <!--Safety Stock-->
                                        PO Purchase Price
                                        <span class="glyphicon glyphicon-chevron-up"
                                              data-ng-click="order('qty')"
                                              data-ng-class="{active: row == 'qty'}"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              data-ng-click="order('-qty')"
                                              data-ng-class="{active: row == '-qty'}"></span>
                                    </div>
                                </th>
                                <!-- <th>
                                     <div class="th">
                                         (Safety+Demand) Qty
                                         <span class="glyphicon glyphicon-chevron-up"
                                               data-ng-click="order('qty')"
                                               data-ng-class="{active: row == 'qty'}"></span>
                                         <span class="glyphicon glyphicon-chevron-down"
                                               data-ng-click="order('-qty')"
                                               data-ng-class="{active: row == '-qty'}"></span>
                                     </div>
                                 </th>

                                <th>
                                    <div class="th">
                                        Supplier Name (By Buyer)
                                        <span class="glyphicon glyphicon-chevron-up"
                                              data-ng-click="order('qty')"
                                              data-ng-class="{active: row == 'qty'}"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              data-ng-click="order('-qty')"
                                              data-ng-class="{active: row == '-qty'}"></span>
                                    </div>
                                </th>-->

                                <th>
                                    <div class="th">
                                        MOQ
                                        <span class="glyphicon glyphicon-chevron-up"
                                              data-ng-click="order('qty')"
                                              data-ng-class="{active: row == 'qty'}"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              data-ng-click="order('-qty')"
                                              data-ng-class="{active: row == '-qty'}"></span>
                                    </div>
                                </th>

                                <th>
                                    <div class="th">
                                        YesterDay Demand
                                        <span class="glyphicon glyphicon-chevron-up"
                                              data-ng-click="order('qty')"
                                              data-ng-class="{active: row == 'qty'}"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              data-ng-click="order('-qty')"
                                              data-ng-class="{active: row == '-qty'}"></span>
                                    </div>
                                </th>

                                <th>
                                    <div class="th">
                                        No of set
                                        <span class="glyphicon glyphicon-chevron-up"
                                              data-ng-click="order('qty')"
                                              data-ng-class="{active: row == 'qty'}"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              data-ng-click="order('-qty')"
                                              data-ng-class="{active: row == '-qty'}"></span>
                                    </div>
                                </th>

                                <th>
                                    <div class="th">
                                        QTY
                                        <span class="glyphicon glyphicon-chevron-up"
                                              data-ng-click="order('qty')"
                                              data-ng-class="{active: row == 'qty'}"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              data-ng-click="order('-qty')"
                                              data-ng-class="{active: row == '-qty'}"></span>
                                    </div>
                                </th>
                                <th>
                                    <div class="th">
                                        Supplier
                                        <span class="glyphicon glyphicon-chevron-up"
                                              data-ng-click="order('qty')"
                                              data-ng-class="{active: row == 'qty'}"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              data-ng-click="order('-qty')"
                                              data-ng-class="{active: row == '-qty'}"></span>
                                    </div>
                                </th>
                                <th>
                                    <div class="th">
                                        Remark
                                        <span class="glyphicon glyphicon-chevron-up"
                                              data-ng-click="order('qty')"
                                              data-ng-class="{active: row == 'qty'}"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              data-ng-click="order('-qty')"
                                              data-ng-class="{active: row == '-qty'}"></span>
                                    </div>
                                </th>
                                <th>
                                    <div class="th">
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-ng-repeat="orderDetail in currentPageStores" style="background-color:{{orderDetail.color}}">
                                <td>
                                    <span ng-if="(UserRoleBackend.rolenames.indexOf('Hub purchase associate')>-1  || UserRoleBackend.rolenames.indexOf('HQ Purchase Executive')>-1)">
                                        <input class="form-control" type="checkbox" style="width: 50px;" ng-model="orderDetail.check" id="chk{{$index+1}}" value="{{orderDetail.check}}" ng-click="chkvalidation(orderDetail,$index+1)" ng-disabled="!orderDetail.IsUpdated" />
                                    </span>
                                </td>
                                <td>{{ $index+1 }}</td>
                                <!--<td>{{orderDetail.Supplier}}</td>-->

                                <td>{{orderDetail.ItemMultiMRPId}}</td>
                                <td>{{orderDetail.itemNumber}}</td>
                                <td>{{orderDetail.ItemName}}</td>
                                <td>
                                    {{orderDetail.ABCClassification}}
                                </td>

                                <td>{{orderDetail.openpoqty}}</td>
                                <td>{{orderDetail.POPurchasePrice}}</td>


                                <!--<td>{{orderDetail.SafetyStock}}</td>
                                <td>{{orderDetail.qty}}</td>-->
                                <!--<td>{{orderDetail.SupplierName}}</td>-->
                                <td>{{orderDetail.conversionfactor}}</td>
                                <td>{{orderDetail.YesDemand}}</td>

                                <td>
                                    <!--{{orderDetail.YesQty}}-->

                                    <input style="width:120px;" type="number" ng-model="orderDetail.NoofSet" id="txtset" ng-keyup="CalQty(orderDetail)" 
                                           ng-disabled="(UserRoleBackend.rolenames.indexOf('Hub purchase associate')>-1  || UserRoleBackend.rolenames.indexOf('HQ Purchase Executive')>-1)"/>
                                </td>
                                <td>

                                    <input style="width:120px;" type="text" ng-model="orderDetail.YesQty" id="txtqty" ng-disabled="true" />
                                </td>

                                <!--<td>{{orderDetail.safetystock + orderDetail.qty}}</td>-->
                                <td>
                                    <select style="width:120px;" class="form-control" id="site-name" ng-model="orderDetail.SupplierId"
                                            ng-disabled="(UserRoleBackend.rolenames.indexOf('Hub purchase associate')>-1  || UserRoleBackend.rolenames.indexOf('HQ Purchase Executive')>-1)">
                                        <option value="">---Select Supplier---</option>
                                        <option value="{{supplier.SupplierId}}" ng-repeat="supplier in suppliers" ng-selected="(orderDetail.SupplierId == supplier.SupplierId)"> {{supplier.SupplierName}}</option>
                                    </select>
                                </td>
                                <td>

                                    <input style="width:120px;" type="text" ng-model="orderDetail.Remark" id="txtremark" 
                                           ng-disabled="(UserRoleBackend.rolenames.indexOf('Hub purchase associate')>-1  || UserRoleBackend.rolenames.indexOf('HQ Purchase Executive')>-1)"/>
                                </td>

                                <td>
                                    <span ng-if="(UserRoleBackend.rolenames.indexOf('Sourcing Executive')>-1  || UserRoleBackend.rolenames.indexOf('Sourcing Associate')>-1 || UserRoleBackend.rolenames.indexOf('Sourcing Senior Executive')>-1)">
                                        <button type="button" value="Update" id="btnSubmit" ng-click="UpdateYesQty(orderDetail)">Update</button>
                                    </span>
                                </td>
                            </tr>
                        </tbody>

                    </table>

                </div>
            </div>
            <footer class="table-footer">
                <div class="row">
                    <div class="col-md-6 page-num-info">
                        <span>
                            Show
                            <select data-ng-model="numPerPage"
                                    data-ng-options="num for num in numPerPageOpt"
                                    data-ng-change="onNumPerPageChange()"></select>
                            entries per page
                        </span>
                    </div>
                    <div class="col-md-6 text-right pagination-container">
                        <pagination class="pagination-sm"
                                    page="currentPage"
                                    total-items="filteredStores.length"
                                    max-size="4"
                                    on-select-page="select(page)"
                                    items-per-page="numPerPage"
                                    rotate="false"
                                    boundary-links="true"></pagination>
                    </div>
                </div>
            </footer>
        </form>
    </section>
</div>
